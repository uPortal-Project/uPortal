<?xml version="1.0" encoding="UTF-8"?>
<!--

    Copyright (c) 2000-2009, Jasig, Inc.
    See license distributed with this file and available online at
    https://www.ja-sig.org/svn/jasig-parent/tags/rel-10/license-header.txt

-->
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://ehcache.svn.sourceforge.net/viewvc/*checkout*/ehcache/branches/ehcache-1.4.0/core/src/main/config/ehcache.xsd?revision=579">

    <!--
     | Please see http://ehcache.sourceforge.net/documentation/configuration.html for detailed information on
     | how to configurigure caches in this file
     +-->

    <!-- Location of persistent caches on disk -->
    <diskStore path="java.io.tmpdir/uPortal" />
    
    <defaultCache eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="600" memoryStoreEvictionPolicy="LRU" />

    <!-- ******************** uPortal Framework Caches ******************** -->
    
    <!-- 
     | Caches AuthorizationPrincipalImpl instances
     | - 1 x user
     | - 1 x channel
     | - 1 x group
     | - not replicated - doesn't represent an updatable data store
     +-->
    <cache name="org.jasig.portal.security.provider.AuthorizationImpl.AUTH_PRINCIPAL_CACHE"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches containing group keys for a permissions target
     | 1 x group x group members
     | - not replicated - doesn't represent an updatable data store
     +-->
    <cache name="org.jasig.portal.security.provider.AuthorizationImpl.ENTITY_PARENTS_CACHE"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="60" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches parsed composite group name strings (ex: "pags.root" to "pags" & "root")
     | - 1 x group
     | - not replicated - doesn't represent an updatable data store
     +-->
    <cache name="org.jasig.portal.groups.CompositeEntityIdentifier.NAME_PARSE_CACHE"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches remote data for CGenericXSLT and CWebProxy
     | - 1 x subscribed user of either channel
     | - not replicated - retrieved content is a per-server action
     | - TODO if content can be verified as Serializable this can be replicated fully (actual copying of data across nodes)
     +-->
    <cache name="org.jasig.portal.channels.CONTENT_CACHE"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="900" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches layout DOM
     | - 1 x user
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.layout.dlm.LAYOUT_CACHE"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="7200" memoryStoreEvictionPolicy="LRU" />
        
    <!-- 
     | Caches layout node reference resolution, only used during import and export
     | - 1 x layout x dlm reference node
     | - not replicated - only used by a command line tool
     +-->
    <cache name="org.jasig.portal.layout.dlm.NODEREF_CACHE"
        eternal="false" maxElementsInMemory="2000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="180" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
        
    <!-- 
     | Caches resolved resource URLs
     | - 1 x classpath resource (framework XSL files and such)
     | - not replicated - pertains to local file system data
     +-->
    <cache name="org.jasig.portal.utils.ResourceLoader.RESOURCE_URL_CACHE"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches failed resource URL resolution
     | - 1 x classpath resource that does not exist (framework XSL files and such)
     | - not replicated - pertains to local file system data
     +-->
    <cache name="org.jasig.portal.utils.ResourceLoader.RESOURCE_URL_NOT_FOUND_CACHE"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="600" memoryStoreEvictionPolicy="LRU" />
        
    <!-- 
     | Caches parsed CPD files
     | - 1 x .cpd file
     | - not replicated - pertains to local file system data
     +-->
    <cache name="org.jasig.portal.portlets.portletadmin.PortletAdministrationHelper.CPD_CACHE"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches IChannel output marked as system wide
     | - 1 x system wide channel cache content
     | - not replicated - pertains to locally generated content
     +-->
    <cache name="org.jasig.portal.ChannelRenderer.SYSTEM_WIDE_CHANNEL_CACHE"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="600" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
        
    <!-- ******************** Per-Datasource Person Directory Caches ******************** -->
    <!-- 
     | Caches the final merge results of a person directory query, short cache to ensure the
     | individual attribute source caches are honored
     | - 1 x user
     | - not replicated - doesn't represent an updatable data store
     +-->
    <cache name="org.jasig.services.persondir.USER_INFO.merged"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="5" timeToLiveSeconds="10" memoryStoreEvictionPolicy="LRU" />
        
    <!-- 
     | Caches queries against the local UP_USER table
     | - 1 x user
     | - not replicated - doesn't represent an updatable data store
     +-->
    <cache name="org.jasig.services.persondir.USER_INFO.up_user"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="600" memoryStoreEvictionPolicy="LRU" />
        
    <!-- 
     | Caches queries against the local UP_PERSON_DIR table
     | - 1 x user
     | - not replicated - doesn't represent an updatable data store
     +-->
    <cache name="org.jasig.services.persondir.USER_INFO.up_person_dir"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="600" memoryStoreEvictionPolicy="LRU" />
        

    <!-- ******************** uPortal IBasicEntity Caches ******************** -->

    <!-- 
     | Caches IEntityGroup objects
     | - 1 x group across all group stores
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.groups.IEntityGroup"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches IEntity objects
     | - 1 x group member (channels, users)
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.groups.IEntity"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches IPermissionSet objects
     | - 1 x per permissions owner (channel manager, user, ...)
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.security.IPermissionSet"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    
    <!-- ******************** Hibernate Caches ******************** -->
    
    <!-- 
     | Caches DLM Evaluator object
     | - 1 x per DLM layout fragment
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.layout.dlm.Evaluator"
        eternal="false" maxElementsInMemory="100" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!--
     | Query cache for Evaluator subclass FragmentDefinition
     | - unique query, no parameters
     +-->
    <cache name="org.jasig.portal.layout.dlm.FragmentDefinition.query.GET_ALL_FRAGMENTS"
        eternal="false" maxElementsInMemory="1" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!--
     | Query cache for Evaluator subclass FragmentDefinition
     | - 1 x per DLM layout fragment
     +-->
    <cache name="org.jasig.portal.layout.dlm.FragmentDefinition.query.FIND_FRAGMENT_BY_NAME"
        eternal="false" maxElementsInMemory="100" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />

    <!-- 
     | Caches ChannelType objects
     | - 1 x channel type
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelTypeImpl"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Query cache for ChannelType
     | - 1 x channel type
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelTypeImpl.query.FIND_CHAN_TYPE_BY_NAME"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Query cache for ChannelType
     | - unique query that gets all channel types
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelTypeImpl.query.FIND_ALL_CHAN_TYPE"
        eternal="false" maxElementsInMemory="1" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />

    <!-- 
     | Caches ChannelDefinition objects
     | - 1 x channel definition
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelDefinitionImpl"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Query cache for ChannelDefinition
     | - unique query, no parameters
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelDefinitionImpl.query.FIND_ALL_CHANNEL_DEFS"
        eternal="false" maxElementsInMemory="1" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Query cache for ChannelDefinition
     | - 1 x channel definition
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelDefinitionImpl.query.FIND_CHANNEL_DEF_BY_FNAME"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Query cache for ChannelDefinition
     | - 1 x channel definition search
     +-->
    <cache name="org.jasig.portal.channel.dao.jpa.ChannelDefinitionImpl.query.FIND_CHANNEL_DEF_BY_NAME"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches PortletDefinitionImpl objects
     | - 1 x published portlet
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletDefinitionImpl"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="21600" memoryStoreEvictionPolicy="LFU" />
    
    <!-- 
     | Caches PortletEntityImpl objects
     | - 1 x subscribed portlet x user
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletEntityImpl"
        eternal="false" maxElementsInMemory="15000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Caches queries by user & subscribe ID for PortletEntityImpl objects
     | - 1 x subscribed portlet x user
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletEntityImpl.query.FIND_PORTLET_ENT_BY_CHAN_SUB_AND_USER"
        eternal="false" maxElementsInMemory="15000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Caches queries by portlet definition id for PortletEntityImpl objects
     | - 1 x portlet definition
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletEntityImpl.query.FIND_PORTLET_ENTS_BY_PORTLET_DEF"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    <!-- 
     | Caches queries by user id for PortletEntityImpl objects
     | - 1 x user
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletEntityImpl.query.FIND_PORTLET_ENTS_BY_USER_ID"
        eternal="false" maxElementsInMemory="1500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches PortletPreferencesImpl objects
     | - 1 x subscribed portlet x user
     | - 1 x published portlet
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletPreferencesImpl"
        eternal="false" maxElementsInMemory="15500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches PortletPreferencesImpl's list of preference objects
     | - 1 x subscribed portlet x user
     | - 1 x published portlet
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletPreferencesImpl.portletPreferences"
        eternal="false" maxElementsInMemory="15500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches PortletPreferenceImpl
     | - 1 x actual stored portlet preference
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletPreferenceImpl"
        eternal="false" maxElementsInMemory="2200" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches PortletPreferenceImpl's list of values
     | - 1 x actual stored portlet preference
     | - replicated by invalidation
     +-->
    <cache name="org.jasig.portal.portlet.dao.jpa.PortletPreferenceImpl.values"
        eternal="false" maxElementsInMemory="2200" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="1800" memoryStoreEvictionPolicy="LRU" />
    
    
    <!-- 
     | Caches last updated timestamp for each hibernate managed table
     | - 1 x hibernate managed table
     | - not replicated - used to track local modifications to tables
     +-->
    <cache name="org.hibernate.cache.UpdateTimestampsCache"
        eternal="false" maxElementsInMemory="100" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />

    <!-- 
     | Caches SQL query level results for entity queries that don't specify an explicit cache region
     | - 1 x managed query result
     | - not replicated - used to track local query results
     +-->
    <cache name="org.hibernate.cache.StandardQueryCache"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="300" memoryStoreEvictionPolicy="LRU" />
        
    
    <!-- Portal Stats Hibernate Caches -->
    
    <!-- 
     | Caches stats EventType objects
     | - 1 x stats EventType
     | - not replicated - data does not change
     +-->
    <cache name="PortalStats.org.jasig.portal.events.EventType"
        eternal="false" maxElementsInMemory="50" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches stats StatsSession objects
     | - 1 x user
     | - not replicated - stats sessions do not change once created
     +-->
    <cache name="PortalStats.org.jasig.portal.events.handlers.db.StatsSession"
        eternal="false" maxElementsInMemory="1000" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="900" timeToLiveSeconds="7200" memoryStoreEvictionPolicy="LRU" />
    
    <!-- 
     | Caches last updated timestamp for each hibernate managed table
     | - 1 x hibernate managed table
     | - not replicated - used to track local modifications to tables
     +-->
    <cache name="PortalStats.org.hibernate.cache.UpdateTimestampsCache"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />

    <!-- 
     | Caches SQL query level results for entity queries that don't specify an explicit cache region
     | - 1 x managed query result
     | - not replicated - used to track local query results
     +-->
    <cache name="PortalStats.org.hibernate.cache.StandardQueryCache"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="300" memoryStoreEvictionPolicy="LRU" />


    <!-- Portal javascript and css gzipping filter cache -->

    <cache name="org.jasig.portal.utils.cache.ConfigurablePageCachingFilter.PAGE_CACHE"
        eternal="false" maxElementsInMemory="250" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <!-- XSLT caches -->
    <!-- 
     | Note: overflowToDisk MUST be false for XSLT caches as these caches store "javax.xml.transform.Templates" or
     | "org.jasig.portal.StylesheetSet" instances which are not Serializable
     +-->
    <cache name="org.jasig.portal.utils.XSLT.STYLESHEET_ROOT_CACHE"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
    <cache name="org.jasig.portal.utils.XSLT.STYLESHEET_SET_CACHE"
        eternal="false" maxElementsInMemory="500" overflowToDisk="false" diskPersistent="false" 
        timeToIdleSeconds="0" timeToLiveSeconds="0" memoryStoreEvictionPolicy="LRU" />
    
</ehcache>
